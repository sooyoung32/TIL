# 값 타입

## JPA의 데이터 타입 분류
### 엔티티 타입

@Entity로 정의하는 객체 

데이터가 변해도 식별자로 지속해서 추적 가능 

## 값 타입

int, integer, string 처럼 값으로 사용하는 자바 기본 타입이나 객체

식별자가 없고 값만 있으므로 변경시 추적 불가 

### 기본값 타입

- 생명주기를 엔티티에 의존 → 회원 삭제 하면 이름, 나이도 다 삭제
- 값 타입은 공유하면 안됨  → 회원 이름 변경했는데 다른 회원 이름이 변경되면 안됨.
- 자바 원시 타입은 공유되지 않음
- 기본 타입은 항상 값을 복사함 or 불변이어야 함
- 래퍼클래스나 String은 공유 가능한 객체이지만 불변객체로 만들어서 부수작용을 없애야함

### 임베디드 타입 (복합 값 타입)

- 새로운 값 타입을 직접 정의 할 수 있음
- 주로 기본 값 타입을 모아 만들어서 복합 값 타입이라고도 함
- int, String 과 같은 값 타입

### 사용법

@Embeddable  값 타입을 정의하는 곳에 표시

@Embedded 값 타입을  사용하는 곳에 표시

기본 생성자 필수 

### 장점

- 재사용
- 높은 응집도
- Period.isWork() 같은 값 타입만 사용하는 의미 있는 메소드르  만들 수 있음
- 갑 타입은 모두 엔티티 생명주기에 의존함

엔티티의 값일 뿐이다

임베디드 타입을 사용하는 전과 후에 매핑하는 테이블은 같다

객체와 테이블을 세밀하게 매핑하는 것이 가능

임베디드 타입과 연관관계

- 임베디드 타입에 엔티티와 관계를 갖을 수 잇음
- 두개의 값 객체를 사용하고 싶을때 칼럼이 중복되기 떄문에 @Attribute Overrides 를 사용하여 칼럼 속명 명을 재정의

임베디드 타입과 null → 매핑 컬럽은  null

### 값 타입과 불변 객체

값 타입 공유 참조 

- 임베디드 타입 값은 같 타입을 여러 엔티티에서 공유하면 위험함...
- 부작용 발생
- 회원 1, 회원 2가 같은 주소를 가지고 있을때?

값 타입 복사

- 값을 복사해서 사용해야 함

값 타입의 한계

- 직접 정의한 값 타입은 자바의 기본 타입이 아니라 객체 타입
- 객체 타입은 참조 값을 직접 대입하는 것을 막을 방법이 없음 ㅠㅠ
- 객체의 공유 참조는...피할 수는 없음

불변객체

- 객체 타입을 불변으로 만들어서 부장용 차단

값 타입 비교

- 인스턴스가 달라도 그 안에 값이 같으면 같은것으로 봐
- 값 타입은 동등성 비교를 해야함
- 동일성 비교
- 동등성 비교

### 컬렉션 값 타입